<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YARA Rule Creator</title>

    <!-- CodeMirror -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/dracula.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/css/main.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <h1>YARA Rule Creator</h1>
            <div class="header-actions">
                <button id="btn-validate" class="btn btn-secondary">
                    <span class="icon">&#10003;</span> Validate
                </button>
                <button id="btn-save" class="btn btn-primary">
                    <span class="icon">&#128190;</span> Save
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Left Panel - Editor -->
            <div class="panel editor-panel">
                <div class="panel-header">
                    <h2>Rule Editor</h2>
                    <div class="template-selector">
                        <select id="template-type">
                            <option value="">-- Select Template --</option>
                            <option value="basic">Basic</option>
                            <option value="strings">Strings</option>
                            <option value="pe_imports">PE Imports</option>
                            <option value="behavioral">Behavioral</option>
                        </select>
                        <button id="btn-generate" class="btn btn-small">Generate</button>
                    </div>
                </div>
                <div class="template-options" id="template-options">
                    <input type="text" id="rule-name" placeholder="Rule Name" class="input">
                    <input type="text" id="rule-author" placeholder="Author" class="input">
                    <input type="text" id="rule-description" placeholder="Description" class="input">
                </div>
                <div class="editor-container">
                    <textarea id="editor"></textarea>
                </div>
                <div class="validation-results" id="validation-results">
                    <!-- Validation results appear here -->
                </div>
            </div>

            <!-- Right Panel - Tools -->
            <div class="panel tools-panel">
                <!-- Tabs -->
                <div class="tabs">
                    <button class="tab active" data-tab="extract">Extract</button>
                    <button class="tab" data-tab="test">Test</button>
                    <button class="tab" data-tab="help">Help</button>
                </div>

                <!-- Extract Tab -->
                <div class="tab-content active" id="tab-extract">
                    <h3>String Extraction</h3>
                    <p class="description">Extract strings and PE info from files</p>

                    <div class="form-group">
                        <label>Upload File</label>
                        <input type="file" id="extract-file" class="input-file">
                    </div>

                    <div class="form-group">
                        <label>Or Enter Path</label>
                        <input type="text" id="extract-path" placeholder="C:\path\to\file.exe" class="input">
                    </div>

                    <div class="form-options">
                        <label><input type="checkbox" id="opt-unicode" checked> Unicode</label>
                        <label><input type="checkbox" id="opt-pe-info" checked> PE Info</label>
                        <label><input type="checkbox" id="opt-classify" checked> Classify</label>
                    </div>

                    <div class="form-group">
                        <label>Min Length: <span id="min-length-val">4</span></label>
                        <input type="range" id="min-length" min="3" max="20" value="4" class="slider">
                    </div>

                    <button id="btn-extract" class="btn btn-primary btn-full">Extract Strings</button>

                    <div class="extraction-results" id="extraction-results">
                        <!-- Extraction results appear here -->
                    </div>
                </div>

                <!-- Test Tab -->
                <div class="tab-content" id="tab-test">
                    <h3>Rule Testing</h3>
                    <p class="description">Test your rule against files</p>

                    <div class="form-group">
                        <label>Upload File</label>
                        <input type="file" id="test-file" class="input-file">
                    </div>

                    <div class="form-group">
                        <label>Or Enter Path (file or directory)</label>
                        <input type="text" id="test-path" placeholder="C:\path\to\scan" class="input">
                    </div>

                    <button id="btn-test-file" class="btn btn-primary btn-full">Test on File</button>
                    <button id="btn-test-path" class="btn btn-secondary btn-full">Test on Path</button>

                    <div class="test-results" id="test-results">
                        <!-- Test results appear here -->
                    </div>
                </div>

                <!-- Help Tab -->
                <div class="tab-content" id="tab-help">
                    <h3>YARA Quick Reference</h3>

                    <div class="help-section">
                        <h4>String Modifiers</h4>
                        <ul>
                            <li><code>ascii</code> - ASCII strings (default)</li>
                            <li><code>wide</code> - UTF-16 strings</li>
                            <li><code>nocase</code> - Case insensitive</li>
                            <li><code>fullword</code> - Match whole words</li>
                            <li><code>xor</code> - XOR encoded</li>
                            <li><code>base64</code> - Base64 encoded</li>
                        </ul>
                    </div>

                    <div class="help-section">
                        <h4>Condition Keywords</h4>
                        <ul>
                            <li><code>all of them</code> - All strings match</li>
                            <li><code>any of them</code> - Any string matches</li>
                            <li><code>N of them</code> - N strings match</li>
                            <li><code>$str at 0</code> - String at offset</li>
                            <li><code>filesize</code> - File size</li>
                            <li><code>uint16(0)</code> - Read bytes</li>
                        </ul>
                    </div>

                    <div class="help-section">
                        <h4>PE Module</h4>
                        <ul>
                            <li><code>pe.is_pe</code> - Is PE file</li>
                            <li><code>pe.imports("dll", "func")</code></li>
                            <li><code>pe.exports("name")</code></li>
                            <li><code>pe.number_of_sections</code></li>
                            <li><code>pe.entry_point</code></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Status Bar -->
        <footer class="status-bar">
            <span id="status-text">Ready</span>
            <span id="cursor-pos">Line 1, Col 1</span>
        </footer>
    </div>

    <!-- CodeMirror JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/yara/yara.min.js"></script>

    <!-- App JS -->
    <script src="/static/js/app.js"></script>
</body>
</html>
